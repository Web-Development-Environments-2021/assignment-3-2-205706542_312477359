const axios = require("axios");
const { getLeagueDetails } = require("./league_utils");
const api_domain = "https://soccer.sportmonks.com/api/v2.0";
const LEAGUE_ID = 271;

async function getTeamInfo(team_id) {
  const team = await axios.get(`${api_domain}/teams/${team_id}`, {
    params: {
      api_token: process.env.api_token,
    },
  });

  const {name, logo_path, venue_id, founded} = team.data;

  return {
      name: name,
      logo_path: logo_path,
      venue_id: venue_id,
      founded: founded,
  };
}

async function getTeamPreviewsByName(team_name) {
  
  let league_teams = []
  
  const teams = await axios.get(`${api_domain}/teams/search/${team_name}`, {
    params: {
      api_token: process.env.api_token,
      include: 'league',
    },
  });
  
  teams.data.data.map((team) => {
    if (team.league.data.id == LEAGUE_ID) {
      league_teams.push({
        id: team.id,
        name: team.name,
        logoPath: team.logo_path
      });
    }
  });


  return league_teams;

}

exports.getTeamInfo = getTeamInfo;
exports.getTeamPreviewsByName = getTeamPreviewsByName;
